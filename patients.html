<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pacientes - Gen15Q Project</title>
    <link rel="stylesheet" href="css/styles.css">
    <style>
        /* Estilos espec칤ficos para pacientes */
        .patient-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .patient-card {
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid #e0e0e0;
        }
        
        .patient-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .patient-card-header {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .patient-card-header h3 {
            margin: 0;
            font-size: 1.1rem;
            color: #2c3e50;
        }
        
        .gender-icon {
            margin-right: 10px;
            font-size: 1.2rem;
        }
        
        .male-icon {
            color: #3498db;
        }
        
        .female-icon {
            color: #e91e63;
        }
        
        .patient-details {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .patient-card.expanded .patient-details {
            max-height: 500px;
            margin-top: 15px;
        }
        
        .symptoms-list {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin: 10px 0;
            padding: 0;
            list-style: none;
        }
        
        .symptoms-list li {
            background: #e3f2fd;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }
        
        .badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: auto;
        }
        
        .mild {
            background: #c8e6c9;
            color: #2e7d32;
        }
        
        .moderate {
            background: #fff9c4;
            color: #f57f17;
        }
        
        .severe {
            background: #ffcdd2;
            color: #c62828;
        }
    </style>
</head>
<body>
    <!-- [Cabecera similar a index.html] -->
    <header>
        <!-- Tu cabecera existente -->
    </header>

    <main class="patients-dashboard">
        <!-- Filtros avanzados -->
        <div class="filters">
            <div class="search-container">
                <input type="text" id="search-input" placeholder="Buscar pacientes...">
                <button id="reset-btn">Reiniciar</button>
            </div>
            
            <div class="filter-group">
                <h3>Filtrar por:</h3>
                <select id="filter-select">
                    <option value="all">Todos</option>
                    <option value="mild">Leve</option>
                    <option value="moderate">Moderado</option>
                    <option value="severe">Grave</option>
                </select>
            </div>
        </div>

        <!-- Contenedor principal de pacientes -->
        <div class="patient-grid" id="patients-container">
            <!-- Las tarjetas se generar치n din치micamente con JavaScript -->
        </div>
    </main>

    <!-- [Pie de p치gina similar a index.html] -->
    <footer>
        <!-- Tu pie de p치gina existente -->
    </footer>

    <script src="js/patients.js"></script>
    <script>
        // patients.js - Versi칩n adaptada para el dise침o colapsable
        document.addEventListener('DOMContentLoaded', function() {
            const DATA_SOURCES = [
                'https://raw.githubusercontent.com/Evelez23/gen15Qproject/main/data/pacientes.json',
                './data/pacientes.json'
            ];
            
            const container = document.getElementById('patients-container');
            const searchInput = document.getElementById('search-input');
            const resetBtn = document.getElementById('reset-btn');
            const filterSelect = document.getElementById('filter-select');
            
            let allPatients = [];
            
            // Cargar y mostrar pacientes
            async function loadPatients() {
                try {
                    // Intenta cada fuente de datos
                    for (const source of DATA_SOURCES) {
                        try {
                            const response = await fetch(source);
                            if (!response.ok) continue;
                            const data = await response.json();
                            allPatients = data.pacientes;
                            renderPatients(allPatients);
                            return;
                        } catch (error) {
                            console.warn(`Error con ${source}:`, error);
                        }
                    }
                    throw new Error("No se pudieron cargar los datos");
                } catch (error) {
                    console.error("Error:", error);
                    container.innerHTML = `<p class="error">${error.message}</p>`;
                }
            }
            
            // Renderizar pacientes
            function renderPatients(patients) {
                container.innerHTML = '';
                
                patients.forEach(patient => {
                    const card = document.createElement('article');
                    card.className = 'patient-card';
                    
                    // Determinar icono de g칠nero
                    const genderIcon = patient.G칠nero === 'M' ? 
                        '<span class="gender-icon male-icon">游녽</span>' : 
                        '<span class="gender-icon female-icon">游녾</span>';
                    
                    // Determinar clase de severidad
                    let severityClass = 'mild';
                    if (patient['Nivel de afectaci칩n'].includes('Moderado')) severityClass = 'moderate';
                    if (patient['Nivel de afectaci칩n'].includes('Grave')) severityClass = 'severe';
                    
                    // Formatear s칤ntomas
                    const symptoms = patient['S칤ntomas principales'].split(';')
                        .map(s => `<li>${s.trim()}</li>`)
                        .join('');
                    
                    card.innerHTML = `
                        <div class="patient-card-header">
                            ${genderIcon}
                            <h3>${patient.Nombre}</h3>
                            <span class="badge ${severityClass}">
                                ${patient['Nivel de afectaci칩n'].split(' ')[0]}
                            </span>
                        </div>
                        <div class="patient-details">
                            <p><strong>Edad:</strong> ${patient.Edad} a침os</p>
                            <ul class="symptoms-list">${symptoms}</ul>
                            <p><strong>Necesidades:</strong> ${patient.Necesidades || 'No especificadas'}</p>
                        </div>
                    `;
                    
                    // Evento para expandir/colapsar
                    card.addEventListener('click', () => {
                        card.classList.toggle('expanded');
                    });
                    
                    container.appendChild(card);
                });
            }
            
            // Filtrado y b칰squeda
            function setupFilters() {
                searchInput.addEventListener('input', filterPatients);
                filterSelect.addEventListener('change', filterPatients);
                resetBtn.addEventListener('click', () => {
                    searchInput.value = '';
                    filterSelect.value = 'all';
                    filterPatients();
                });
            }
            
            function filterPatients() {
                const searchTerm = searchInput.value.toLowerCase();
                const severityFilter = filterSelect.value;
                
                const filtered = allPatients.filter(patient => {
                    // Filtrar por b칰squeda
                    const matchesSearch = 
                        patient.Nombre.toLowerCase().includes(searchTerm) || 
                        patient['S칤ntomas principales'].toLowerCase().includes(searchTerm);
                    
                    // Filtrar por severidad
                    let matchesSeverity = true;
                    if (severityFilter !== 'all') {
                        const severity = patient['Nivel de afectaci칩n'].toLowerCase();
                        matchesSeverity = 
                            (severityFilter === 'mild' && severity.includes('leve')) ||
                            (severityFilter === 'moderate' && severity.includes('moderado')) ||
                            (severityFilter === 'severe' && severity.includes('grave'));
                    }
                    
                    return matchesSearch && matchesSeverity;
                });
                
                renderPatients(filtered);
            }
            
            // Inicializar
            loadPatients();
            setupFilters();
        });
    </script>
</body>
</html>
